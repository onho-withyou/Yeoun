<th:block xmlns:th="http://www.thymeleaf.org"
          xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
          layout:decorate="~{layouts/layout}">

<th:block layout:fragment="content">
<style>
  /* ----[ ë„¤ ë””ìì¸ ê·¸ëŒ€ë¡œ ìœ ì§€ ]---- */
  :root{
    --bg:#f6f8fb;
    --card:#ffffff;
    --line:#e6eaf2;
    --text:#0f172a;
    --muted:#475569;
    --subtle:#64748b;
    --accent:#0ea5a4;
    --accent-strong:#0d9488;
    --accent-soft:#ccfbf1;
    --head:#f1f5f9;
  }
  body{margin:0;background:var(--bg);font-family:"Noto Sans KR";}
  .container{max-width:1200px;margin:0 auto;padding:18px 20px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .grid{display:grid;gap:18px}
  .two{grid-template-columns:1fr 1fr}
  @media(max-width:980px){.two{grid-template-columns:1fr}}
  .panel,.card{background:#fff;border:1px solid var(--line);border-radius:14px;padding:16px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px 12px;border-bottom:1px solid var(--line)}
  th{background:var(--head)}
  .right{text-align:right}
  .muted{color:#64748b}
  .mini{font-size:12px}
  .btn{padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
  .btn-ghost{border:1px solid var(--line);background:#fff}
  .btn-soft{background:var(--accent-soft);border:1px solid #99f6e4}
</style>


<div class="container-xxl py-4">

  <div class="container row">
    <div class="grow">
      <h1>ê¸‰ì—¬ ëª…ì„¸ì„œ ì¡°íšŒ</h1>
      <div class="subtitle">ì›”ë³„ ê¸‰ì—¬ëª…ì„¸ì„œ í™•ì¸ Â· PDF ë‹¤ìš´ë¡œë“œ Â· ë¬¸ì˜ ë“±ë¡</div>
   

   <div class="toolbar">
    <a th:href="@{|/pay/emp_pay?yymm=${prev}|}" class="btn btn-ghost nav-btn">â—€ ì´ì „</a>

    <input id="month" type="month"
           class="month-input"
           th:value="${#strings.substring(yymm,0,4)} + '-' + ${#strings.substring(yymm,4,6)}">

    <a th:href="@{|/pay/emp_pay?yymm=${next}|}" class="btn btn-ghost nav-btn">ë‹¤ìŒ â–¶</a>

    <button class="btn btn-soft pdf-btn" id="printBtn">ğŸ–¨ PDF ì €ì¥</button>
</div>

     </div>
  </div>


  <!-- ########## ì‹ ê·œ ì¶”ê°€: header nullì¼ ë•Œ ì²˜ë¦¬ ########## -->
  <section th:if="${header == null}">
    <div class="panel" style="text-align:center; padding:40px">
      <h2 th:text="${error != null ? error : 'ê¸‰ì—¬ëª…ì„¸ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.'}"></h2>
      <p class="muted">ì„ íƒí•œ ì›”ì— ëŒ€í•œ ê¸‰ì—¬ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>

      <a th:href="@{/pay/emp_pay}" class="btn btn-ghost" style="margin-top:12px">í˜„ì¬ì›”ë¡œ ì´ë™</a>
    </div>
    <!-- header ì—†ìœ¼ë©´ ì•„ë˜ ë³¸ë¬¸ ì „ì²´ ë Œë”ë§ ì•ˆí•¨ -->
    <div style="display:none" ></div>
  </section>



  <!-- ########## header ìˆì„ ë•Œë§Œ ëª…ì„¸ì„œ ë³¸ë¬¸ ì¶œë ¥ ########## -->
  <section th:if="${header != null}">

    <!-- Summary -->
    <section class="grid two">
      <div class="panel">
        <div class="muted mini"
             th:text="${#strings.substring(yymm,0,4)} + '-' + ${#strings.substring(yymm,4,6)}"></div>

        <div class="kpi"
             th:text="'â‚©' + ${#numbers.formatInteger(header.netAmt,3,'COMMA')}"></div>

        <div class="kpi-sub">ì‹¤ìˆ˜ë ¹ì•¡</div>
      </div>

      <div class="panel">
        <div class="row" style="justify-content:space-between">
          <div>
            <strong th:text="${header.empName}"></strong>
            <span class="badge" th:text="${header.posName}"></span>
           <span class="badge bg-primary" th:text="${header.posName}"></span>

            
            

            <div class="muted mini">
              ë¶€ì„œ: <span th:text="${header.deptName}"></span>
              Â· ì‚¬ë²ˆ: <span th:text="${header.empId}"></span>
            </div>
          </div>

          <div class="right mini">
            ì§€ê¸‰ì¼: <span th:text="${payDate}">-</span>
          </div>
        </div>
      </div>
    </section>


    <!-- ì§€ê¸‰ / ê³µì œ -->
    <section class="grid two">

      <!-- ì§€ê¸‰ í•­ëª© -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <h3>ì§€ê¸‰ í•­ëª©</h3>
          <span class="muted mini"
                th:text="${#lists.size(items.?[type=='ALW'])} + 'ê°œ'"></span>
        </div>

        <table>
          <thead><tr><th>í•­ëª©</th><th class="right">ê¸ˆì•¡</th><th class="right">ë¹„ê³ </th></tr></thead>
          <tbody>
            <tr th:each="i : ${items}" th:if="${i.type=='ALW'}">
              <td th:text="${i.itemName}"></td>
              <td class="right" th:text="'â‚©' + ${#numbers.formatInteger(i.amount,3,'COMMA')}"></td>
              <td class="right muted"></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th>ì†Œê³„</th>
              <th class="right"
                  th:text="'â‚©' + ${#numbers.formatInteger(header.alwAmt,3,'COMMA')}"></th>
              <th></th>
            </tr>
          </tfoot>
        </table>
      </div>


      <!-- ê³µì œ í•­ëª© -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <h3>ê³µì œ í•­ëª©</h3>
          <span class="muted mini"
                th:text="${#lists.size(items.?[type=='DED'])} + 'ê°œ'"></span>
        </div>

        <table>
          <thead><tr><th>í•­ëª©</th><th class="right">ê¸ˆì•¡</th><th class="right">ë¹„ê³ </th></tr></thead>
          <tbody>
            <tr th:each="i : ${items}" th:if="${i.type=='DED'}">
              <td th:text="${i.itemName}"></td>
              <td class="right" th:text="'â‚©' + ${#numbers.formatInteger(i.amount,3,'COMMA')}"></td>
              <td class="right muted"></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th>ì†Œê³„</th>
              <th class="right"
                  th:text="'â‚©' + ${#numbers.formatInteger(header.dedAmt,3,'COMMA')}"></th>
              <th></th>
            </tr>
          </tfoot>
        </table>
      </div>

    </section>

  </section> <!-- header != null END -->

</div>


<script>
document.getElementById('printBtn').addEventListener('click', ()=>window.print());
</script>

</th:block>
</th:block>
