<th:block xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layouts/layout.html}">

<th:block layout:fragment="content">
	<div class="custom-body container-xxl flex-grow-1 container-p-y">
	
		<h2>공정 현황</h2>
		
		<div class="row g-2 align-items-center">
			<form id="processSearchForm">
				<div class="row gx-3 gy-2 align-items-center">
					<!-- 작업일자 -->
					<div class="col-md-3">
					  <label class="form-label" for="workDate">작업지시일자</label>
					  <input type="date" class="form-control" id="workDate">
					</div>
					<!-- 제품 구분-->
					<div class="col-md-2">
						<label class="form-label" for="searchProcess">현재공정</label>
						<select class="form-select" id="searchProcess">
							<option value="">전체</option>
						</select>
					</div>
					<!-- 상태 구분-->
					<div class="col-md-2">
						<label class="form-label" for="searchHStatus">상태</label>
						<select class="form-select" id="searchHStatus">
							<option value="">전체</option>
						</select>
					</div>
					<div class="col-md-3">
						<label class="form-label" for="searchKeyword">검색어</label>
						<input type="text" class="form-control" id="searchKeyword" placeholder="검색어 입력">
					</div>
					<div class="col-md-2">
						<label class="form-label d-block">&nbsp;</label>
						<button type="button" class="btn btn-outline-primary w-100" id="btnSearchProcess">검색</button>
					</div>
				</div>
			</form>
		</div>

		<br>

		<div class="card">
			<div class="card-body p-0">
				<div id="processGrid"></div>
			</div>
		</div>
	</div>
	
	<!-- DETAIL MODAL (공정 단계 전체 보기) -->
	<div class="modal fade" id="detailModal" tabindex="-1">
	  <div class="modal-dialog modal-xl modal-dialog-scrollable">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">작업지시 공정 상세</h5>
	        <button class="btn-close" data-bs-dismiss="modal"></button>
	      </div>
	
	      <div class="modal-body">
	
	        <!-- SUMMARY -->
	        <div class="row g-2 mb-3 small" id="summaryGrid"></div>
	
	        <div class="table-responsive small">
	          <table class="table table-bordered table-sm" id="stepTable">
	            <thead class="table-light">
	            <tr>
	              <th style="width: 50px;">단계</th>
	              <th style="width: 60px;">공정명</th>
	              <th style="width: 50px;">상태</th>
	              <th style="width: 130px;">시작</th>
	              <th style="width: 130px;">종료</th>
	              <th style="width: 60px;">예상</th>
				  <th style="width: 60px;">지연</th>
	              <th style="width: 70px;">양품수량</th>
	              <th style="width: 70px;">불량수량</th>
	              <th style="width: 90px;">작업</th>
	              <th>특이사항</th>
	            </tr>
	            </thead>
	            <tbody></tbody>
	          </table>
	        </div>
	
	      </div>
	
	      <div class="modal-footer">
	        <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">닫기</button>
	      </div>
	    </div>
	  </div>
	</div>


	
	<!-- 공정 종료 시 수량 입력 모달 -->
	<div class="modal fade" id="finishModal" tabindex="-1">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      
	      <div class="modal-header">
	        <h5 class="modal-title">공정 종료 - 생산 수량 입력</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
	      </div>
	
	      <div class="modal-body">
	
	        <!-- Hidden -->
	        <input type="hidden" id="finish-orderId">
	        <input type="hidden" id="finish-stepSeq">
	
	        <!-- (선택) 계획 수량 표시 -->
	        <div class="mb-3">
	          <label class="form-label">계획 수량</label>
	          <input type="text" id="finish-planQty" class="form-control" readonly>
	        </div>
	
	        <!-- 기준값 표시 (1~2단계: 기준 배합량, 3단계~: 기준 완제품 수량 등) -->
	        <div class="mb-3">
	          <label class="form-label" id="finish-standardLabel">
	            기준값
	          </label>
	          <input type="text" id="finish-standardQty" class="form-control" readonly>
	          <small class="text-muted" id="finish-standardHelp">
	            공정 단계에 따라 계산된 기준값입니다.
	          </small>
	        </div>
	
	        <hr>
	
	        <!-- 실제 수량 입력 -->
	        <div class="mb-3">
	          <label class="form-label">양품 수량</label>
	          <input type="number" id="finish-goodQty" class="form-control" min="0">
	        </div>
	
	        <div class="mb-3">
	          <label class="form-label">불량 수량</label>
	          <input type="number" id="finish-defectQty" class="form-control" min="0">
	        </div>
	
	      </div>
	
	      <div class="modal-footer">
	        <button class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
	        <button class="btn btn-success" id="btnFinishSubmit">저장하고 종료</button>
	      </div>
	
	    </div>
	  </div>
	</div>



	

	<script src="/js/process/processStatus.js"></script>		

</th:block>
</th:block>
