<th:block xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layouts/layout.html}">
<body>
<th:block layout:fragment="content">
	<div class="custom-body container-xxl flex-grow-1 container-p-y">
	
	<h2>인사 신규 등록</h2>

	  <form th:action="@{/emp/regist}" th:object="${empDTO}" method="post" novalidate>
	<!-- 	<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> -->
	
	    <!-- 상단 2컬럼 카드 -->
	    <div class="row g-4 mb-5">
	      <!-- 기본정보 -->
	      <div class="col-md-6">
	        <div class="card h-100">
	          <div class="card-body">
	            <h5 class="card-title mb-3">기본정보</h5>
	
	            <div class="row g-3">
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="empName">이름</label>
	                <input type="text" class="form-control" id="empName" th:field="*{empName}" placeholder="홍길동">
	                <div class="text-danger small" th:if="${#fields.hasErrors('empName')}" th:errors="*{empName}"></div>
				  </div>
				  
				  <!-- 사번은 서비스에서 생성됨: 입력받지 않기 or 읽기전용(바인딩X) -->
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="empNo">사번</label>
	                <input type="text" class="form-control" id="empNo" placeholder="자동생성" readonly>
	              </div>
	            </div>
	
	            <div class="row g-3 mt-0">
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="gender">성별</label>
	                <select class="form-select" id="gender" th:field="*{gender}">
	                  <option value="">선택</option>
	                  <option value="M">남</option>
	                  <option value="F">여</option>
	                </select>
	                <div class="text-danger small" th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}"></div>
<!-- 	                <div class="invalid-feedback d-block" -->
<!-- 					     th:if="${#fields.hasErrors('gender')}" -->
<!-- 					     th:errors="*{gender}"></div> -->
	              </div>
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="hireDate">입사일</label>
	                <input type="date" class="form-control" id="hireDate" th:field="*{hireDate}">
	                <div class="text-danger small" th:if="${#fields.hasErrors('hireDate')}" th:errors="*{hireDate}"></div>
	              </div>
	            </div>
	
	            <div class="row g-3 mt-0">
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="rrn">주민등록번호</label>
	                <!-- RRN은 DTO 미바인딩(정책 확정 전) -->
	                <input type="text" class="form-control" id="rrn" placeholder="000000-0000000" inputmode="numeric">
	              </div>
	              <div class="col-12 col-md-6">
	                <label class="form-label" for="photo">사원 사진</label>
	                <!-- 파일업로드 아직 미구현: 바인딩X -->
	                <input type="file" class="form-control" id="photo">
	              </div>
	            </div>
	          </div>
	        </div>
	      </div>
	
	      <!-- 연락/계정 -->
			<div class="col-md-6">
			  <div class="card h-100">
			    <div class="card-body">
			      <h5 class="card-title mb-3">연락/계정</h5>
			
			      <!-- 이메일 / 연락처 -->
			      <div class="row g-3">
			        <div class="col-12 col-md-6">
			          <label class="form-label" for="email">이메일</label>
			          <input type="email" class="form-control" id="email" th:field="*{email}" placeholder="name@company.com">
			          <div class="text-danger small" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
			        </div>
			        <div class="col-12 col-md-6">
			          <label class="form-label" for="phone">연락처</label>
			          <input type="tel" class="form-control" id="phone" th:field="*{mobile}" placeholder="010-1234-5678">
			          <div class="text-danger small" th:if="${#fields.hasErrors('mobile')}" th:errors="*{mobile}"></div>
			        </div>
			      </div>
			
			      <!-- 주소 -->
			      <div class="row g-3 mt-0">
			        <div class="col-12">
			          <label class="form-label">주소</label>
			
			          <!-- 우편번호 + 검색버튼 -->
			          <div class="input-group mb-2">
			          	<input type="text" class="form-control" id="zipcode" th:field="*{postCode}" placeholder="우편번호">
			            <input class="btn btn-outline-secondary" type="button" onclick="btnSearchZip()" value="우편번호 찾기"><br>
			          </div>
			
			          <!-- 기본주소 -->
			          <input type="text" class="form-control mb-2" id="address" th:field="*{address1}" placeholder="도로명 주소">
			          <!-- 상세주소 -->
			          <input type="text" class="form-control" id="addressDetail" th:field="*{address2}" placeholder="상세 주소">
					  <div class="text-danger small" th:if="${#fields.hasErrors('postCode')}" th:errors="*{postCode}"></div>
					  <div class="text-danger small" th:if="${#fields.hasErrors('address1')}" th:errors="*{address1}"></div>
			        </div>
			      </div>
			
			    </div>
			  </div>
			</div>
	    </div>
	
	    <!-- 조직/직무 (현재 DTO에 없음 → 바인딩 보류) -->
	    <div class="card mb-4">
	      <div class="card-body">
	        <h5 class="card-title mb-3">조직/직무</h5>
	
	        <div class="row g-3">
	          <div class="col-12 col-md-4">
	            <label class="form-label" for="empType">종류</label>
	            <select class="form-select" id="empType">
	              <option value="">선택</option>
	              <option>ERP</option>
	              <option>MES</option>
	            </select>
	          </div>
	          <div class="col-12 col-md-4">
	            <label class="form-label" for="dept">부서</label>
	            <select class="form-select" id="dept">
	              <option value="">선택</option>
	              <option>개발부</option>
	              <option>마케팅부</option>
	              <option>생산부</option>
	              <option>영업부</option>
	              <option>인사부</option>
	            </select>
	          </div>
	          <div class="col-12 col-md-4">
	            <label class="form-label" for="position">직급</label>
	            <select class="form-select" id="position">
	              <option value="">선택</option>
	              <option>대리</option>
	              <option>과장</option>
	              <option>차장</option>
	            </select>
	          </div>
	        </div>
	      </div>
	    </div>
	
	    <!-- 급여통장 정보 (DTO에 아직 없음 → 바인딩 보류) -->
	    <div class="card mb-4">
	      <div class="card-body">
	        <h5 class="card-title mb-3">급여통장 정보</h5>
	
	        <div class="row g-3">
	          <div class="col-12 col-md-6">
	            <label class="form-label" for="bank">은행</label>
	            <select class="form-select" id="bank">
	              <option value="">선택</option>
	              <option>신한은행</option>
	              <option>국민은행</option>
	              <option>우리은행</option>
	            </select>
	          </div>
	          <div class="col-12 col-md-6">
	            <label class="form-label" for="accountNo">계좌번호</label>
	            <input type="text" class="form-control" id="accountNo" placeholder="123-456-789012">
	          </div>
	        </div>
	
	        <div class="row g-3 mt-0">
	          <div class="col-12 col-md-6">
	            <label class="form-label" for="accountHolder">예금주</label>
	            <input type="text" class="form-control" id="accountHolder" placeholder="홍길동">
	          </div>
	          <div class="col-12 col-md-6">
	            <label class="form-label" for="bankFile">통장사본 첨부</label>
	            <input type="file" class="form-control" id="bankFile">
	          </div>
	        </div>
	      </div>
	    </div>
	
	    <!-- 버튼 (뷰 확인용) -->
	    <div class="d-flex justify-content-end gap-2">
	      <a href="/emp/list" class="btn btn-outline-secondary">취소</a>
	      <button type="submit" class="btn btn-primary">저장</button>
	    </div>
	  </form>
	</div>
	
<script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
  function btnSearchZip() {
    new daum.Postcode({
      oncomplete: function(data) {
        // 기본 주소(도로명/지번) 선택 타입에 따라 결정
        var addr = '';             // 최종 주소
        var extraRoadAddr = '';    // 참고항목 (법정동/건물명 등)

        if (data.userSelectedType === 'R') { // 도로명
          addr = data.roadAddress;

          // 참고항목 생성
          if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
            extraRoadAddr += data.bname;
          }
          if (data.buildingName !== '' && data.apartment === 'Y') {
            extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
          }
          if (extraRoadAddr !== '') {
            addr += ' (' + extraRoadAddr + ')';
          }
        } else { // J: 지번주소
          addr = data.jibunAddress;
        }

        // 값 세팅
        document.getElementById('zipcode').value = data.zonecode; // 우편번호
        document.getElementById('address').value = addr;          // 기본주소
        document.getElementById('addressDetail').focus();         // 상세주소로 커서 이동
      }
    }).open();
  }
</script>

	
</th:block>
</body>