<th:block xmlns:th="http://www.thymeleaf.org"
          xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
          layout:decorate="~{/layouts/layout.html}">
          

<body>
<th:block layout:fragment="content">
    <div class="custom-body container-xxl flex-grow-1 container-p-y">
    
	<!-- 메시지 출력 -->
	<div id="empMsgHolder" th:if="${msg}" th:data-msg="${msg}"></div>
	
    <h2>사원 목록</h2>

      <!-- 검색 바 -->
      <div class="row align-items-center g-2 mb-3">
        <div class="col-12 col-lg-9">
        
          <form class="row g-2 align-items-center" th:action="@{/emp}" method="get" role="search">
          
          	<!-- 부서 셀렉트 -->
            <div class="col-6 col-md-auto">
              <select class="form-select" id="deptId" name="deptId" th:disabled="${isDeptManager and !isAdmin}">
                <option value="" th:if="${isAdmin}">부서 전체</option>
                <option th:each="d : ${deptList}" th:value="${d.deptId}" th:text="${d.deptName}"
                        th:selected="${deptId != null and deptId == d.deptId}"
                        th:if="${d.parentDeptId != null}">
                </option>
              </select>
            </div>
            
            <!-- 키워드 -->
            <div class="col-12 col-md-auto">
              <input class="form-control" id="keyword" name="keyword" type="search"
                     placeholder="사번 / 성명 / 부서 / 직급 / 이메일 검색" style="width:280px;" th:value="${keyword}">
            </div>
            
            <div class="col-6 col-md-auto d-grid">
              <button class="btn btn-outline-primary" id="btnSearch" type="button">검색</button>
            </div>
          </form>
        </div>
        <div class="col-12 col-lg-3 d-grid d-lg-flex justify-content-lg-end">
          <a href="/emp/regist" class="btn btn-primary" 
          	th:if="${#authorization.expression('hasRole(''HR_ADMIN'') or hasRole(''SYS_ADMIN'')')}">
          	인사 등록
          </a>
        </div>
      </div>
      
      <!-- 사원 상세 정보 모달 -->
	  <th:block th:replace="~{/emp/emp_detail_modal :: emp-detail-modal}"></th:block>

      <!-- 그리드 DOM 반드시 포함 -->
      <div class="card-body p-0">
	    <div id="grid"></div>
      </div>
      
      <br>
      
      <nav aria-label="사원 목록 페이지네이션">
		<ul class="pagination justify-content-center" id="empPagination"></ul>
      </nav>
      
    </div>

<!-- 초기 데이터 JS로 넘기기 -->
<script th:inline="javascript">
  const initialEmpList = /*[[${empList}]]*/ [];
</script>    

<script src="/js/emp/empList.js"></script>

</th:block>
</body>