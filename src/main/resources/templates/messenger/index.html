<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{/layouts/layout.html}">
<head>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/line-awesome/1.3.0/line-awesome/css/line-awesome.min.css" rel="stylesheet"/>
  <link rel="stylesheet" th:href="@{/css/messenger/messenger.css}"/>
  <link rel="stylesheet" th:href="@{/css/messenger/index.css}"/>
</head>
<div layout:fragment="content" class="main-wrapper">
    <div class="container">
      <div class="page-content">
        <div class="container mt-5">
          <div class="row">
            <!-- ===== 왼쪽: 친구 목록 ===== -->
            <div class="col-md-4 col-12 card-stacked">
              <div class="card shadow-line mb-3 chat">
                <div class="chat-user-detail">
                  <div class="p-3 chat-header">
                    <div class="w-100 d-flex align-items-center">
                      <a href="#" class="user-undetail-trigger btn btn-sm btn-icon btn-light active text-dark me-2">
                        <i class="bi bi-chevron-left"></i>
                      </a>
                      <p class="fw-400 mb-0 text-dark-75">Profile</p>
                    </div>
                  </div>
                  <div class="p-3 chat-user-info text-center">
                    <img src="https://user-images.githubusercontent.com/35243461/168796876-2e363a49-b32c-4218-b5a3-ce12493af69e.jpg" class="rounded-circle img-fluid shadow avatar-xxl mb-3">
                    <h6 class="fw-300 mb-1">Quan Albert</h6>
                    <p class="text-muted">Web Developer</p>
                    <div class="mt-3">
                      <a href="#" class="btn btn-light-skype btn-icon btn-circle btn-sm btn-shadow me-2"><i class="bx bxl-skype"></i></a>
                      <a href="#" class="btn btn-light-facebook btn-icon btn-circle btn-sm btn-shadow me-2"><i class="bx bxl-facebook"></i></a>
                      <a href="#" class="btn btn-light-twitter btn-icon btn-circle btn-sm btn-shadow me-2"><i class="bx bxl-twitter"></i></a>
                      <a href="#" class="btn btn-light-instagram btn-icon btn-circle btn-sm btn-shadow"><i class="bx bxl-instagram"></i></a>
                    </div>
                  </div>
                </div>

               <div class="status-bar">
                    <div class="d-flex align-items-center">
                        <div class="status-indicator" id="status-indicator"></div>
                        <span class="status-text" id="status-text">온라인</span>

                        <select class="status-select" id="work-status">
                        <option selected>근무 중</option>
                        <option>회의 중</option>
                        <option>식사 중</option>
                        <option>외출 중</option>
                        </select>
                    </div>
                    </div>


                <div class="chat-search px-3 py-2">
                  <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search conversation">
                    <span class="input-group-text"><i class="las la-search drop-shadow fs-5"></i></span>
                  </div>
                </div>

                <div class="archived-messages d-flex align-items-center px-3 py-2">
                  <div class="svg15 archived me-2"></div>
                  <p class="fw-400 text-dark-75 mb-0">Archived</p>
                </div>

                <!-- 대화 목록 -->
                <div class="chat-user-panel">
                  <div class="pb-3 d-flex flex-column chat-user-scroll">
                    <div class="chat-item d-flex px-3 py-2 align-items-center">
                      <div class="profile-wrapper">
                        <img class="rounded-circle shadow avatar-sm me-3" 
                            src="https://user-images.githubusercontent.com/35243461/168796884-ee3aafb6-8083-48ec-9cfb-51b95eae08fe.jpg">
                        <span class="status-dot online"></span> <!-- ✅ 상태 표시 추가 -->
                      </div>
                      <div class="flex-fill">
                        <p class="fw-400 text-dark-75 mb-0">Emily Woods</p>
                        <span class="text-muted fs-13">I'm looking forward to it</span>
                      </div>
                      <small class="text-muted">08:55</small>
                    </div>
                    <div class="chat-item active d-flex px-3 py-2 align-items-center">
                      <img class="rounded-circle shadow avatar-sm me-3" src="https://user-images.githubusercontent.com/35243461/168796877-f6c8819a-5d6e-4b2a-bd56-04963639239b.jpg">
                      <div class="flex-fill">
                        <p class="fw-400 text-dark-75 mb-0">Beate Lemoine</p>
                        <span class="text-muted fs-13">Hey Quan, meet tonight?</span>
                      </div>
                      <span class="badge bg-success ms-2">2</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ===== 오른쪽: 대화창 ===== -->
            <div class="col-md-8 col-12 card-stacked">
              <div class="card shadow-line mb-3 chat chat-panel">
                <div class="p-3 chat-header d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <img class="rounded-circle shadow avatar-sm me-3" src="https://user-images.githubusercontent.com/35243461/168796877-f6c8819a-5d6e-4b2a-bd56-04963639239b.jpg">
                    <div>
                      <p class="fw-400 mb-0 text-dark-75">Beate Lemoine</p>
                      <p class="sub-caption text-muted text-small mb-0"><i class="la la-clock me-1"></i>last seen 09:15 PM</p>
                    </div>
                  </div>
                  <div>
                    <button class="btn btn-sm btn-light text-dark"><i class="bi bi-info-circle"></i></button>
                    <button class="btn btn-sm btn-light text-dark"><i class="bi bi-camera-video"></i></button>
                    <button class="btn btn-sm btn-light text-dark"><i class="bi bi-search"></i></button>
                    <button class="btn btn-sm btn-light text-dark"><i class="bi bi-three-dots"></i></button>
                  </div>
                </div>

                <div class="left-chat-message mb-2">
                  <p>Hi, Quan</p>
                  <span class="msg-time">06:15</span>
                </div>

                <div class="d-flex flex-row-reverse mb-2">
                  <div class="right-chat-message">
                    <p>Hey, Beate!</p>
                    <span class="msg-time">
                      06:49
                      <i class="bi bi-check"></i> <!-- 전송됨 -->
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-row-reverse mb-2">
                  <div class="right-chat-message">
                    <p>See you later!</p>
                    <span class="msg-time">
                      07:01
                      <i class="bi bi-check"></i> <!-- 읽음됨 -->
                    </span>
                  </div>
                </div>

                <!-- 메시지 입력창 -->
                <div class="chat-search px-3 py-2">
                  <div class="input-group align-items-center">
                    <input type="text" class="form-control" placeholder="Write a message...">
                    <span class="input-group-text bg-white border-0">
                      <i class="fs-5 bi bi-file-earmark-plus me-2"></i>
                      <i class="fs-5 bi bi-emoji-smile me-2"></i>
                      <i class="fs-5 bi bi-camera me-2"></i>
                      <i class="fs-5 bi bi-send"></i>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div><!-- row -->
        </div>
      </div>
    </div>
</div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/1.5.5/perfect-scrollbar.min.js"></script>

  <script layout:fragment="myScript">
    (function($) {
      "use strict";
      $('.chat-user-scroll').each(function() { new PerfectScrollbar(this); });
      $('.chat-panel-scroll').each(function() { new PerfectScrollbar(this); });

      $('.chat-upload-trigger').on('click', function(e) {
        $(this).parent().find('.chat-upload').toggleClass("active");
      });
      $('.user-detail-trigger, .user-undetail-trigger').on('click', function(e) {
        $(this).closest('.chat').find('.chat-user-detail').toggleClass("active");
      });
    })(jQuery);

    const statusIndicator = document.getElementById('status-indicator');
	const statusText = document.getElementById('status-text');
	const workStatus = document.getElementById('work-status');
	
	let statuses = [
	  { color: '#4CAF50', text: '온라인' },
	  { color: '#FFC107', text: '자리비움' },
	  { color: '#F44336', text: '다른 용무중' }
	];
	
	let current = 0;
	statusIndicator.addEventListener('click', () => {
	  current = (current + 1) % statuses.length;
	  statusIndicator.style.backgroundColor = statuses[current].color;
	  statusText.textContent = statuses[current].text;
	});

  </script>

</html>