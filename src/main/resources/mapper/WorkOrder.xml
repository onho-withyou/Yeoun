<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yeoun.order.mapper.OrderMapper">

	<resultMap id="EmpListMap" type="com.yeoun.emp.dto.EmpListDTO">
	    <result property="empId" column="emp_id"/>
	    <result property="empName" column="emp_name"/>
	    <result property="deptName" column="dept_name"/>
	    <result property="posName" column="pos_name"/>
	</resultMap>

	<select id="selectOrderList" resultType="com.yeoun.order.dto.WorkOrderListDTO">
		select 
			w.order_id,
			pp.plan_id,
			ppi.prd_id,
			m.prd_name,
			w.plan_qty,
			w.plan_start_date as start_date,
			w.plan_end_date as end_date,
			w.status,
			w.outbound_yn,
			w.created_date,
			w.remark
		from work_order w
		join production_plan pp
			on w.plan_id = pp.plan_id
		join production_plan_item ppi
			on w.plan_id = ppi.plan_id
		join product_mst m
			on w.prd_id = m.prd_id
		order by w.order_id desc
	</select>
	
	<select id="selectWorkers" resultMap="EmpListMap">
		select
			e.emp_id,
			e.emp_name,
			d.dept_name,
			p.pos_name
		from emp e
		join dept d
			on e.dept_id = d.dept_id
		join position p
			on e.pos_code = p.pos_code
		where d.dept_id = 'DEP003'
		<if test= 'pos != null and !pos.equals("")'>
			and p.pos_code = #{pos}
		</if>
	</select>
	
</mapper>
